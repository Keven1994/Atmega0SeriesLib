<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.9">
<title>0 Series Library Userguide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>0 Series Library Userguide</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_programmierung">Programmierung</a></li>
<li><a href="#_grundsätzliches">Grundsätzliches</a></li>
<li><a href="#_basics">Basics</a></li>
<li><a href="#_ressourcecontroller">Ressourcecontroller</a></li>
<li><a href="#_eventsystem">Eventsystem</a></li>
<li><a href="#_twi">TWI</a>
<ul class="sectlevel2">
<li><a href="#_beispielbehandlung_twi_address_nack">Beispielbehandlung TWI Address-NACK</a></li>
<li><a href="#_lesen_mit_fifo_keine_interrupts">Lesen mit FiFo, keine Interrupts</a></li>
<li><a href="#_schreiben_mit_fifo_keine_interrupts">Schreiben mit FiFo, keine Interrupts</a></li>
<li><a href="#_lesen_nicht_blockierend_keine_interrupts_keine_fifo">Lesen nicht blockierend, keine Interrupts, keine FiFo</a></li>
<li><a href="#_lesen_nicht_blockierend_scoped_variante">Lesen nicht blockierend, Scoped-Variante</a></li>
<li><a href="#_schreiben_nicht_blockierend_scoped_variante">Schreiben nicht blockierend, Scoped-Variante</a></li>
<li><a href="#_schreiben_nicht_blockierend_fifo_mit_interrupts">Schreiben nicht blockierend, FiFo mit Interrupts</a></li>
<li><a href="#_lesen_nicht_blockierend_fifo_mit_interrupts">Lesen nicht blockierend, FiFo mit Interrupts</a></li>
<li><a href="#_lesen_und_schreiben_nicht_blockierend_fifo_mit_interrupts">Lesen und schreiben nicht blockierend, FiFo mit Interrupts</a></li>
</ul>
</li>
<li><a href="#_spi">SPI</a>
<ul class="sectlevel2">
<li><a href="#_schreiben_nicht_blockierend_fifo_ohne_interrupts">Schreiben, nicht blockierend, FiFo ohne Interrupts</a></li>
<li><a href="#_schreiben_nicht_blockierend_fifo_mit_interrupts_2">Schreiben, nicht blockierend, FiFo mit Interrupts</a></li>
</ul>
</li>
<li><a href="#_usart">USART</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_programmierung">Programmierung</h2>
<div class="sectionbody">
<div class="ulist">
<div class="title">Um die Programme auf die Chips der Atmega 0 Serie zu flashen gibt es grundsätzlich 2 Methoden:</div>
<ul>
<li>
<p><a href="https://github.com/ElTangas/jtag2updi" class="bare">https://github.com/ElTangas/jtag2updi</a> hier wird ein Atmega328 oder ein vergleichbarer Chip zu einem Programmer umfunktioniert, hierzu kann z.B. ein fertiges Arduino-Board genutzt werden.</p>
</li>
<li>
<p><a href="https://github.com/mraardvark/pyupdi" class="bare">https://github.com/mraardvark/pyupdi</a> hier wird mithilfe eines USB-UART Adapters geflashed, hier muss darauf geachtet werden dass der Widerstand stimmt, sollte der Widerstand nicht funktionieren muss eine Diode mit der Anode zu UPDI und Kathode zu Tx verbunden werden.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_grundsätzliches">Grundsätzliches</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Die Library stützt sich auf den AVR-GCC 8.3+, es werden intern unter anderem Concepts genutzt, die Verwendung eines aktuellen C++ Compilers ist daher notwendig.</p>
</li>
<li>
<p>Am besten wird das enthaltene CMakefile genutzt um das Projekt zu erstellen, um den UC zu wechseln muss lediglich die Variable 'Mnumber' und 'F_CPU' abgeändert werden.</p>
</li>
<li>
<p>[Optional] um ein schnelleres Compilieren zu ermöglichen kann nach dem ersten Compilieren die Variable GenerateHWFiles auf FALSE gestellt werden.</p>
</li>
<li>
<p>Die Library kann auf Windows und Linux genutzt werden, sollte auf dem Ziel-Windows "sh.exe" in der Shell vorhanden sein wird sich CMake beschweren und beim ersten Versuch abbrechen, zur Behebung muss dann ein zweites Mal CMake aufgerufen werden.</p>
</li>
<li>
<p>Es sollten nur die HW-Abstraktionen inkludiert werden, ansonsten kann kein ordnungsgemäßes funktionieren gewährleistet werden.</p>
</li>
<li>
<p>Der Erste Include MUSS MCUSelect.hpp sein, hier findet die Auswahl des Gerätes statt.</p>
</li>
<li>
<p>Port, PortPin und der Ressource Controller sind Standardmäßig inkludiert und müssen nicht nochmal explizit inkludiert werden.</p>
</li>
<li>
<p>Es ist notwendig, dass die von Atmel bereitgestellten header, library-files sowie device-specs der toolchain hinzugefügt werden.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basics">Basics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Zunächst wird betrachtet wie die Ports oder auch spezifische Pins über die Library angesteuert werden.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="c++">#include "MCUSelect.hpp"
#include "hw_abstractions/Delay.hpp"

using portA = AVR::port::Port&lt;AVR::port::A&gt;;
using portC = AVR::port::Port&lt;AVR::port::C&gt;; <i class="conum" data-value="1"></i><b>(1)</b>
using led1 = AVR::port::Pin&lt;portA,2&gt;;
using led3 = AVR::port::Pin&lt;portA,3&gt;;
using led4 = AVR::port::Pin&lt;portA,4&gt;;
using led5 = AVR::port::Pin&lt;portA,5&gt;; <i class="conum" data-value="2"></i><b>(2)</b>

using led2 = typename portC::pins::pin3; <i class="conum" data-value="3"></i><b>(3)</b>

int main() {

    portA::setDir&lt;AVR::port::Out&gt;(); <i class="conum" data-value="4"></i><b>(4)</b>
    led2::setOutput(); <i class="conum" data-value="5"></i><b>(5)</b>
    while(true){
        led1::toggle();
        if(led2::isOn())
            led3::toggle();
        led2::toggle();
        AVR::port::pinsOutToggle&lt;led4,led5&gt;(); <i class="conum" data-value="6"></i><b>(6)</b>
        AVR::delay&lt;AVR::ms,500&gt;(); <i class="conum" data-value="7"></i><b>(7)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Portauswahl</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Pinauswahl</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Sichere Pinauswahl über den Port</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Pin auf Output setzen mit Port Funktion</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Pin auf Output setzen mit Pin Funktion</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Mehrere Pins mit freier Funktion togglen</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Delay-Funktion</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Zunächst werden die Ports ausgewählt welche angesprochen werden sollen, hier in diesem Falle Port A und C. Sollte bei der Auswahl ein Compiler Fehler auftreten wurde ein nicht existenter Port ausgewählt (der Atmega4808 besitzt z.B. keinen Port B oder E obwohl es Defines dafür gibt). Der nächste Schritt ist die Auswahl von spezifischen Pins, dafür wird dem template-Alias der zuvor gewählte Port sowie die Pin Nummer angegeben. Hier muss darauf geachtet werden dass die spezifischen Pins NICHT auf Verfügbarkeit geprüft werden, um sicher zu gehen können die Pins auch aus dem Port entnommen werden (s.a. Led2), die hier enthaltenen Pins sind definitiv physikalisch vorhanden. Nachdem die Auswahl für Ports und/oder Pins getroffen wurden können auf diesen Operationen ausgeführt werden. Es könne sowohl auf den Ports als auch auf den Pins spezifische Operationen ausgeführt werden (z.B. toggle, on, off,setDir ….). Sollen auf mehreren Pins gleichzeitig Operationen ausgeführt werden, so können die freien Funktionen in AVR::port genutzt werden. Bei den freien Funktionen ist zu beachten, dass nur Pins des gleichen Ports übergeben werden können, verschiedene Ports lösen einen Compiler-Fehler aus. Die Port Klasse besitzt noch die Convenience-Methode „get“ um auf Register zuzugreifen, damit kann von außerhalb auf ein spezifisches Register (z.B. pin0ctrl) zugegriffen werden. Wenn möglich sollte diese Methode aber vermieden und vorhandene abstraktere Klassen-Methoden genutzt werden. Im obigen Beispiel findet sich die delay-Methode, diese wrappt die C _delay Methoden und rechnet je nach Einheit (us, ms, s) korrekt um. Des weiteren gibt es noch eine safeDelay-Methode, diese schaltet die Interrupts für die Dauer des wartens ab und funktioniert somit immer korrekt (sollten die Interrupts angeschaltet gewesen sein werden sie nach Ablauf des delays wieder aktiviert).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ressourcecontroller">Ressourcecontroller</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die Library stellt eine Klasse zur Verfügung mit welcher die Ressourcen auf ihre Kollisionsfreiheit überprüft werden können. Wenn diese Klasse genutzt wird ist es ausgeschlossen dass darin angeforderte Ressourcen sich überschneiden, wenn z.B TWI PortA Pin 3 braucht und eine weitere Ressource diesen Pin belegen wollen würde, so würde das Programm nicht kompilieren und eine entsprechende Fehlermeldung ausgegeben.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using twiInstance = AVR::rc::Instance&lt;
        AVR::twi::TWI,
        AVR::rc::Number&lt;0&gt;,
        AVR::portmux::PortMux&lt;0&gt;&gt;;

using usartInstance = AVR::rc::Instance&lt;
        AVR::usart::USART_Comp,
        AVR::rc::Number&lt;2&gt;,
        AVR::portmux::PortMux&lt;0&gt;&gt;; <i class="conum" data-value="1"></i><b>(1)</b>

using RC = AVR::rc::RessourceController&lt;twiInstance,usartInstance&gt;; <i class="conum" data-value="2"></i><b>(2)</b>

using twiRessource = RC::getRessource_t&lt;twiInstance&gt;;
using usartRessource = RC::getRessource_t&lt;usartInstance&gt;; <i class="conum" data-value="3"></i><b>(3)</b>

using usart = AVR::usart::USART&lt;AVR::blocking,usartRessource&gt;;

using twi = AVR::twi::TWIMaster&lt;AVR::blocking,twiRessource , AVR::ReadWrite&gt;; <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Auswahl der gewünschten Ressourcen Instanzauswahl</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Instanziieren des RessourceController mit den gewünschten Ressourcen</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Anfordern einer Ressource</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Übergeben einer Ressource</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Zuerst wird die spezifische Instance einer Ressource festgelegt, diese besteht aus der Ressource selbst, diese sind immer in den dazugehörigen namespaces abgelegt (z.B. TWI/USART). Danach wird der RessourceController mit den zu benutzenden Instanzen belegt, danach kann mit der getRessource_t Klassen-Methode die Ressource angefordert werden. Sollten anderweitig noch Pins genutzt werden (z.B vom Benutzer für led&#8217;s oder sonstiges) so kann/sollte eine GenericRessource erzeugt und übergeben werden (Auch hier wird die physikalische Existenz der Pins nicht überprüft!).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using led1 = Pin&lt;PortA, 0&gt;;
using led2 = Pin&lt;PortA, 1&gt;;
using led3 = Pin&lt;PortD, 6&gt;;

using gRes = AVR::rc::GenericRessource&lt;led1,led2,led3&gt;; <i class="conum" data-value="1"></i><b>(1)</b>

using RC = AVR::rc::RessourceController&lt;twiIntance,usartInstance,gRes &gt;; <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instanziieren einer generischen Ressource</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Instanziieren des RessourceControllers mit der generischen Ressource</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Wenn alle Ressourcen mit dem RessourceController überprüft werden ist ein Konflikt der Ressourcen Belegung zur Compile-Zeit ausgeschlossen. Zu beachten ist allerdings dass bei den meisten Ressourcen wie z.B. TWI, USART und SPI alle Pins welche dort benutzt werden können auch geprüft werden. Sollte also z.B. MasterSPI als ReadOnly konfiguriert werden so wird logischerweise der Miso-Pin nicht benutzt, aber im RessourceController trotzdem geprüft.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using spiRessource = AVR::rc::Instance&lt;
AVR::spi::SPI,
AVR::rc::Number&lt;0&gt;,
AVR::portmux::PortMux&lt;0&gt;&gt;;

using uncheckedSPI = AVR::rc::UncheckedRessource_t&lt;spiRessource&gt;; <i class="conum" data-value="1"></i><b>(1)</b>
using spi = AVR::spi::SPIMaster&lt;AVR::notBlocking&lt;AVR::UseFifo&lt;42&gt; ,AVR::Interrupts&lt;&gt; &gt;,uncheckedSPI , AVR::ReadOnly&gt;; <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instanziieren einer ungeprüften Ressource</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Übergabe der ungeprüften Ressource an SPI</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Sollte der besagte Pin trotzdem von einer anderen Ressource verwendet werden besteht die Möglichkeit eine Ressource von der Prüfung auszuschließen indem UncheckedRessource verwendet wird.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_eventsystem">Eventsystem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Das Eventsystem der 0 Serie ermöglicht Peripherie Abhängige Funktionalitäten mit deren Hilfe die Peripherie ohne Interrupts Synchron und Asynchron miteinander kommunizieren kann. Das Eventsystem kann nur so konfiguriert werden dass je Kanal ein Generator läuft und dieser Kanal jeweils von beliebig vielen Users abgehört werden kann. Das Eventsystem ist hauptsächlich dazu gedacht Interrupts und den damit verbundenen Overhead zu vermeiden.</p>
</div>
<div class="ulist">
<div class="title">Generatoren:</div>
<ul>
<li>
<p>Je Kanal kann ein Generator eingeschaltet werden, diese haben bestimmte Bedingungen um Events auszulösen, z.B. löst der SPI-Generator immer zum Master-Takt ein Event aus.</p>
</li>
<li>
<p>Beachtet werden müssen hier auch die Constraints, Wenn z.B. ein PortPin als Generator festgelegt wird, soll ein Event ausgelöst werden bei einem High-Pegel, dazu muss aber der Pegel für mindestens einen Taktzyklus Stabil sein.</p>
</li>
<li>
<p>Des weiteren muss auch die Eventlänge beachtet werden, ein Generator kann ein Event z.B. als Pulse oder auch als Level ausgeben (hat wiederum Auswirkungen auf den User).</p>
</li>
<li>
<p>Die Bedingungen, die Eventlänge sowie die Constraints müssen vor der Verwendung im Manual nachgelesen werden.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Es können auch Software-Events generiert werden (immer Synchron als Strobe).
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">User:</div>
<ul>
<li>
<p>Je Kanal können beliebig viele User registriert werden, die Benutzer reagieren dann auf die Events welche von dem Generator erzeugt werden.</p>
</li>
<li>
<p>Wenn z.B. ein Pin als User gewählt wird, so wird das Event auf den Pin abgebildet, also falls ein Event generiert wird, so ist der Pegel High, sonst Low (beachte Eventlänge).</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Wichtig ist zu beachten ob die Events die der Generator erzeugt Synchron oder Asynchron sind, dies muss im Manual nachgelesen werden.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using ch0 = AVR::eventsystem::Channel&lt;0&gt;; <i class="conum" data-value="1"></i><b>(1)</b>
using ch0_gen = typename ch0::generators::generals::spi0_sck; <i class="conum" data-value="2"></i><b>(2)</b>
using user0 = typename ch0::users::evtca0;
using user1 = typename ch0::users::evtcb0; <i class="conum" data-value="3"></i><b>(3)</b>

int main() {
    ch0::template registerListener&lt;user0,user1&gt;(); <i class="conum" data-value="4"></i><b>(4)</b>
    ch0::template setGenerator&lt;ch0_gen &gt;(); <i class="conum" data-value="5"></i><b>(5)</b>
    ch0::softwareEvent(); <i class="conum" data-value="6"></i><b>(6)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Kanalauswahl</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Generatorauwahl</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Userauswahl</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>User auf Kanal registrieren</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Generator an Kanal zuweisen</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Software-Event auslösen</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Zunächst wird der Kanal ausgewählt welcher benutzt werden soll (Kanal 0- maximal 8), sollte hier ein ungültiger Kanal gewählt werden wird das Programm nicht kompilieren. Als nächstes wird der Generator und der/die Benutzer ausgewählt. Dann werden die Benutzer auf den Kanal eingestellt und der Generator wird für den Kanal eingestellt. Das Eventsystem ermöglicht des Weiteren das Auslösen von Software-Events, dies wird mir der entsprechenden Funktion ermöglicht.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_twi">TWI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die TWI Schnittstelle ist aus Aufwandsgründen nur für den Master Modus eingerichtet, die Quick-Command Funktionalität wurde aus Gründen der Kompatibilität zwischen TWI und I²C abgeschaltet, hier wurden Probleme bei der Kommunikation zwischen verschiedenen Geräten sichtbar. Ansonsten kann die TWI-Master Schnittstelle mit allen möglichen Eigenschaften konfiguriert werden, empfehlenswert ist aber lediglich die Anpassung der Zugriffsart (RW / R / W) sowie Blockierend / nicht blockierend oder auch Interruptdriven, ob eine FiFo genutzt wird und Instanzauswahl (wenn die anderen Eigenschaften angepassst werden so ist das Verhalten NICHT getestet), nachfolgend einige Beispiele.
Die Frequenzrate wird über die init Methode festgelegt, sofern fastmode plus nicht aktiviert ist (default Einstellung ist aus), so ist die rate auf 400khz beschränkt.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Es wird nicht kontrolliert ob der Slave die Adresse bestätigt hat ,dieser Fall sollte/muss abgefangen werden!
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_beispielbehandlung_twi_address_nack">Beispielbehandlung TWI Address-NACK</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">auto rd = twi::scopedRead&lt;43&gt;();

while(! twi::writeComplete()) { <i class="conum" data-value="1"></i><b>(1)</b>
    while(! twi::slaveAcknowledged()) { <i class="conum" data-value="2"></i><b>(2)</b>
        while (!twi::endTransaction());  <i class="conum" data-value="3"></i><b>(3)</b>
        rd = twi::scopedRead&lt;43&gt;(); <i class="conum" data-value="4"></i><b>(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Warten auf Beendigung der Start-Condition</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Acknowledgment abfragen</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Stop-Condition auslösen</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Neuer Versuch starten</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Hier wird außerhalb der Schnittstelle zuerst effektiv auf das Beenden der Start-Condition gewartet, danach wird eine Stop-Condition ausgelöst damit die Start-Condition wiederholt werden kann. Die Behandlung besteht hier darin es solange zu versuchen bis der Slave bestätigt, andere Behandlungsmethoden sind z.B. das versuchen einer anderen Adresse oder eine andere Programm-Routine auszuführen. Eine weitere Möglichkeit ist der Schnittstelle als 4. Parameter einen Handler in form eines lambda oder einer Funktion mitzugeben, per Default Parameter ist keiner festgelegt ('AVR::DefaultNackHandler'). Intern wird nach der Start-Condition gewartet bis die Adresse geschrieben wurde und der Slave geantwortet hat, sollte hier ein NACK festgestellt werden so wird der NackHandler so lange ausgeführt bis ein ACK erhalten wurde oder der Handler ein true zurückgibt (z.B. könnte hier Punk 3 und 4 als lambda und return false an die TWI-Schnittstelle übergeben werden).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using _twi = AVR::twi::TWIMaster&lt;AVR::blocking, twires, AVR::ReadWrite&gt;; <i class="conum" data-value="1"></i><b>(1)</b>

static inline auto handler = [](){
    while (!_twi::endTransaction());
    while(!_twi::startTransaction&lt;42,AVR::twi::access::Read&gt;());
}; <i class="conum" data-value="2"></i><b>(2)</b>

using twi = AVR::twi::TWIMaster&lt;AVR::blocking, twires, AVR::ReadWrite, handler&gt;; <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Deklarieren der Schnittstelle ohne handler</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Definieren des handlers</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Einsetzen des Handlers in die Schnittstelle</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Hier wird nochmal gezeigt wie so ein built-in Handler realisiert werden kann</p>
</div>
</div>
<div class="sect2">
<h3 id="_lesen_mit_fifo_keine_interrupts">Lesen mit FiFo, keine Interrupts</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using twi = AVR::twi::TWIMaster&lt;AVR::notBlocking&lt;AVR::UseFifo&lt;42&gt;,AVR::NoInterrupts&gt;,twires , AVR::ReadOnly&gt;;

volatile bool wasread = false;

static inline void Callback (){
    wasread=true;
    uint8_t item;
    while(twi::getInputFifo().pop_front(item))
        AVR::dbgout::put(item);
} <i class="conum" data-value="1"></i><b>(1)</b>

int main() {
    twi::init&lt;100000&gt;(); <i class="conum" data-value="2"></i><b>(2)</b>
    AVR::dbgout::init();
    while(true){
        twi::get&lt;42,Callback&gt;(12); <i class="conum" data-value="3"></i><b>(3)</b>
        while(!wasread)
            twi::periodic(); <i class="conum" data-value="4"></i><b>(4)</b>
        AVR::dbgout::flush();
        AVR::delay&lt;AVR::ms,200&gt;();
        wasread = false;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Definition des Read-Callbacks</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Initialisieren der TWI-Schnittstelle mit 100 KHZ-Frequenz</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Lese-Anforderung mit Callback</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Periodic Aufruf</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dieses Beispiel zeigt die Konfiguration der Schnittstelle als nicht blockierend, Readonly, mit Fifo und ohne Interrupts, bei der TWI Schnittstelle wurde auf eine nicht blockierende Variante ohne FiFo verzichtet, da diese Version mangels Abstraktion zu fehleranfällig wäre. Die get Methode wird mit den template Parametern der Addresse und einer Callback Funktion (oder auch lambda) versehen, als Parameter wird die Anzahl der zu lesenden Bytes übergeben. Ohne Interrupts muss in der Schleife periodic aufgerufen werden, sonst werden weder Daten empfangen noch gesendet. Wenn der Lesevorgang vollendet wurde (die angegebene Anzahl an Bytes wurde gelesen), wird die Callback Funktion aufgerufen und der Benutzer kann festlegen was passieren soll (sinnvoll ist auf jedenfall die FiFo zu leeren wie im Beispiel).</p>
</div>
</div>
<div class="sect2">
<h3 id="_schreiben_mit_fifo_keine_interrupts">Schreiben mit FiFo, keine Interrupts</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">static constexpr const char* hello = "Hello Slave";

int main() {
    twi::init();

    static constexpr auto len = utils::strlen(hello);

    while(true){
        twi::put&lt;42&gt;((uint8_t*)hello,len);
            while( twi::dataToSend()) <i class="conum" data-value="1"></i><b>(1)</b>
                twi::periodic();

        AVR::delay&lt;AVR::ms,200&gt;();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Überprüfen ob in der Fifo nicht gesendete Daten sind</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Hier im Beispiel wird die Verwendung des Schreibens gezeigt, hier wird solange periodic aufgerufen bis keine Daten zum Schreiben mehr vorhanden sind.</p>
</div>
</div>
<div class="sect2">
<h3 id="_lesen_nicht_blockierend_keine_interrupts_keine_fifo">Lesen nicht blockierend, keine Interrupts, keine FiFo</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using twi = AVR::twi::TWIMaster&lt;AVR::notBlocking&lt;AVR::NoFifo,AVR::NoInterrupts&gt;,twires , AVR::ReadOnly&gt;;
static constexpr uint8_t size = 12;
static uint8_t arr[size];

int main() {
    twi::init();
    while(true){
        while(!twi::startTransaction&lt;42,AVR::twi::access::Read&gt;()); <i class="conum" data-value="1"></i><b>(1)</b>
        uint8_t tmp = 0;
        while(tmp != size){
            tmp += twi::receive(arr,size-tmp); <i class="conum" data-value="2"></i><b>(2)</b>
        }

        AVR::delay&lt;AVR::ms,200&gt;();

    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Auslösen der Start-Condition für lesen</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Lesen mit Rückgabe der gelesenen Bytes</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>wird keine FiFo genutzt dann wird von der receive Methode die Anzahl gelesener Bytes zurückgegeben (bei einem einzelnen Lesevorgang ein Boolean ob ein Byte gelesen wurde), logischerweise muss der Anwender ohne FiFo eigene Maßnahmen treffen um entsprechend viele Bytes zu lesen (siehe Beispiel code). Auch das Auslösen der Start – sowie StopCondition müssen dann manuell eingepflegt werden, Ausnahme betrifft das lesen, hier wird die stop-Condition mit dem lesen des letzen Bytes austomatisch ausgeführt.</p>
</div>
</div>
<div class="sect2">
<h3 id="_lesen_nicht_blockierend_scoped_variante">Lesen nicht blockierend, Scoped-Variante</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">static constexpr uint8_t size = 12;
static uint8_t arr[size];
int main() {
    twi::init();
    while(true){
        uint8_t tmp = 0;
        auto rd = twi::scopedRead&lt;42&gt;(); <i class="conum" data-value="1"></i><b>(1)</b>
        uint8_t data;
        while(tmp != 11){
            if(rd.receive(data)) <i class="conum" data-value="2"></i><b>(2)</b>
                arr[tmp++] = data;
        }
        while(!rd.receiveLast(data)); <i class="conum" data-value="3"></i><b>(3)</b>
        arr[tmp] = data;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Erzeugen einer Scoped-Transaktion</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Lesen eines Bytes</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Lesen des Letzten Bytes</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternativ können bei nicht verwenden der nicht blockierenden NoFifo Varianten auch Scoped Varianten genutzt werden, somit muss sich nicht mehr explizit um die Start-Stop Conditions gekümmert werden, auch hier gilt die Ausnahme des Lesens (siehe Beispiel).</p>
</div>
</div>
<div class="sect2">
<h3 id="_schreiben_nicht_blockierend_scoped_variante">Schreiben nicht blockierend, Scoped-Variante</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">static constexpr const char* hello = "Hello Slave";

int main() {
    twi::init();

    static constexpr auto len = utils::strlen(hello);

    while(true){
        auto wr = twi::scopedWrite&lt;42&gt;();
        for(uint8_t i = 0; i &lt; len; ) {
            if (wr.send((uint8_t) *(hello + i)))
                i++;
        }

        AVR::delay&lt;AVR::ms,200&gt;();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hier wird noch die ScopedWrite Variante gezeigt, somit muss der Nutzer sich nicht um Start-Stop Conditions kümmern.</p>
</div>
</div>
<div class="sect2">
<h3 id="_schreiben_nicht_blockierend_fifo_mit_interrupts">Schreiben nicht blockierend, FiFo mit Interrupts</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">static constexpr const char* hello = "Hello Slave";
using twi = AVR::twi::TWIMaster&lt;AVR::notBlocking&lt;AVR::UseFifo&lt;42&gt;,AVR::Interrupts&lt;&gt;&gt;,twires , AVR::WriteOnly&gt;;

ISR(TWI0_TWIM_vect){ <i class="conum" data-value="1"></i><b>(1)</b>
    twi::intHandler(); <i class="conum" data-value="2"></i><b>(2)</b>
}

int main() {
    twi::init();
    static constexpr auto len = utils::strlen(hello);

    while(true){
        twi::put&lt;42&gt;((uint8_t*)hello,len);
        AVR::delay&lt;AVR::ms,200&gt;();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Definition des entsprechenden Interrupt-Vektors</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Aufruf des Interrupt-Handlers</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Diese Interrupt gesteuerte Version wird im Intervall von 200 ms den String Hello Slave an den Slave mit der Addresse 42 senden.</p>
</div>
</div>
<div class="sect2">
<h3 id="_lesen_nicht_blockierend_fifo_mit_interrupts">Lesen nicht blockierend, FiFo mit Interrupts</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using twi = AVR::twi::TWIMaster&lt;AVR::notBlocking&lt;AVR::UseFifo&lt;42&gt;,AVR::Interrupts&lt;&gt;&gt;,twires , AVR::ReadOnly&gt;;

volatile bool wasread = false;

ISR(TWI0_TWIM_vect){
    twi::intHandler();
}

static inline void Callback (){
    wasread=true;
    uint8_t item;
    while(twi::getInputFifo().pop_front(item))
        AVR::dbgout::put(item);
}

int main() {
    twi::init();
    AVR::dbgout::init();
    while(true){
        twi::get&lt;42,Callback&gt;(12);
        while(!wasread)
            ; <i class="conum" data-value="1"></i><b>(1)</b>
        AVR::dbgout::flush();
        AVR::delay&lt;AVR::ms,200&gt;();
        wasread = false;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Kein Periodic da Interruptgesteuert</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Diese Version erhält vom Slave mit der Addresse 42 je Iteration 12 Datenbytes, nachdem diese gelesen wurden wird der Callback ausgeführt (in diesem Falle werden die Datenbytes über die Debug-Schnittstelle an den PC gesendet → nur 4808 verfügbar und die innere While-Schleife der main Methode unterbrochen).</p>
</div>
</div>
<div class="sect2">
<h3 id="_lesen_und_schreiben_nicht_blockierend_fifo_mit_interrupts">Lesen und schreiben nicht blockierend, FiFo mit Interrupts</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using twi = AVR::twi::TWIMaster&lt;AVR::notBlocking&lt;AVR::UseFifo&lt;42&gt;,AVR::Interrupts&lt;&gt;&gt;,twires , AVR::ReadWrite&gt;;

ISR(TWI0_TWIM_vect){
    twi::intHandler();
}

volatile bool wasread = false;
static inline void Callback (){
    wasread=true;
    uint8_t item;
    while(twi::getInputFifo().pop_front(item))
        AVR::dbgout::put(item);
}

int main() {
    twi::init();
    AVR::dbgout::init();
    while(true){
        twi::get&lt;42,Callback&gt;(12); <i class="conum" data-value="1"></i><b>(1)</b>
        while(!wasread)
            ;
        AVR::dbgout::flush();
        twi::put&lt;42&gt;('H'); <i class="conum" data-value="2"></i><b>(2)</b>
        AVR::delay&lt;AVR::ms,200&gt;();
        wasread = false;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Lesen von 12 Bytes</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Schreiben eines Bytes</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Als abschließendes Beispiel wird hier noch eine kombinierte Version gezeigt (lesen und Schreiben).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spi">SPI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Das SPI-Interface ist ähnlich gestaltet wie bei TWI, mit der Ausnahme dass hier in keinem Fall auf start- oder stop-Conditions oder der gleichen geachtet werden muss. Weiterhin wird auch ein Interrupthandler für die Benutzung ohne Fifo und der Slave Modus zur Verfügung gestellt. Hier gibt es keine Option in der init Methode die Frequenz einzustellen, dies geschieht über die Prescaler-Option während der Schnittstellen-Konfiguration.</p>
</div>
<div class="sect2">
<h3 id="_schreiben_nicht_blockierend_fifo_ohne_interrupts">Schreiben, nicht blockierend, FiFo ohne Interrupts</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using spi = AVR::spi::SPIMaster&lt;AVR::notBlocking&lt;AVR::UseFifo&lt;42&gt; ,AVR::NoInterrupts &gt;,res, AVR::ReadWrite&gt;;

int main() {
    spi::init();
    AVR::dbgout::init();
    while(true){
        spi::put('h');
        spi::put('e');
        spi::put('l');
        spi::put('l');
        spi::put('o');
        for(uint8_t i = 0; i &lt; 5; i++) {
            spi::periodic();
            AVR::delay &lt; AVR::us, 5 &gt; ();
        }
        uint8_t item;
       while(spi::getInputFifo().pop_front(item)) {
           AVR::dbgout::put(item);
       }
        AVR::dbgout::flush();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Die Nicht blockierende Variante ohne Interrupts lässt sich ebenso verwenden wie die TWI-Schnittstelle.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_schreiben_nicht_blockierend_fifo_mit_interrupts_2">Schreiben, nicht blockierend, FiFo mit Interrupts</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using spi = AVR::spi::SPIMaster&lt;AVR::notBlocking&lt;AVR::UseFifo&lt;42&gt; ,AVR::Interrupts&lt;&gt; &gt;,res, AVR::ReadWrite&gt;;

ISR(SPI0_INT_vect){
    spi::intHandler();
}

int main() {
    spi::init();
    AVR::dbgout::init();
    while(true){
        spi::put('h');
        spi::put('e');
        spi::put('l');
        spi::put('l');
        spi::put('o');
        uint8_t item;
       while(spi::getInputFifo().pop_front(item)) {
           AVR::dbgout::put(item);
       }
        AVR::dbgout::flush();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hier zu sehen ist eine Interrupt-Version des SPI, um die gelesenen Bytes auszugeben muss lediglich die fifo ausgelesen werden (siehe Beispiel). Wird eine ReadWrite Variante genutzt so wird die Library eine Null transferieren sofern keine Nutzdaten vorhanden sind. Sollte keine Fifo verwendet und kein WriteOnly eingestellt sein so muss ein Protokolladapter festgelegt werden.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usart">USART</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die USART Schnittstelle lässt sich im Grunde genauso bedienen wie SPI und TWI.</p>
</div>
<div class="ulist">
<div class="title">Hier müssen besonders 2 Dinge beachtet werden:</div>
<ul>
<li>
<p>Baudrate: Hier ist es essentiell wichtig dass vor allem der F_CPU Wert stimmt und das eine zu dem Ziel-Gerät passende Baudrate eingestellt ist (default 115200).</p>
</li>
<li>
<p>Besonderheit Interrupts: Hier gibt es 2 Interrupt Vectoren (der TX-Vector wird nicht beachtet) und deswegen auch 2 Interrupt-Handler (tx/rxHandler).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Für den Atmega4808 ist ein Debug-Interface in der Library enthalten (AVR::dbgout → include Datei = inc/Boards/CuriosityNanoIOT.hpp), mit diesem kann für das IoT-Devboard von Microchip über das USB-Interface bequem kommuniziert werden, dabei ist zu beachten das dieses blockierend arbeitet und USART2 benutzt.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="C++">using usart =AVR::usart::USART&lt;AVR::notBlocking&lt;AVR::UseFifo&lt;42&gt;, AVR::Interrupts&lt;&gt;&gt;,usartres, AVR::ReadWrite&gt;;

ISR(USART2_DRE_vect){
    usart::txHandler();
} <i class="conum" data-value="1"></i><b>(1)</b>
ISR(USART2_RXC_vect){
    usart::rxHandler();
} <i class="conum" data-value="2"></i><b>(2)</b>

int main() {
    usart::init&lt;115200&gt;(); <i class="conum" data-value="3"></i><b>(3)</b>
    while(true){
        usart::put('h');
        usart::put('e');
        usart::put('l');
        usart::put('l');
        usart::put('o');
        AVR::delay&lt;AVR::ms,200&gt;();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Transfer Vektor (DRE)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Receive Vektor (TXC)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Initialisierung der Schnittstelle mit 115,2 KHZ-Baudrate</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Hier im Beispiel wird die Verwendung der Interrupt Variante für Read und Write Zugang beschrieben, beachtet werden muss dass der TX Vector nicht verwendet werden darf, stattdessen muss der DRE Vector verwendet werden.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-05-17 18:46:02 +0200
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>
</body>
</html>